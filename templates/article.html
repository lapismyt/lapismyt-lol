{% extends "base.html" %}

{% block og_title %}{{ article.title }}{% endblock %}

{% block og_description %}{% if article.content|length > 80 %}{{ article.content[:80] }}...{% else %}{{ article.content }}{% endif %}{% endblock %}

{% block css %}
form {
  display: inline-block;
}
{% endblock %}

{% block meta %}
<meta property="og:type:article:author" content="{{ article.author.username }}" />
<meta property="og:type:article:published_time" content="{{ article.created_at.isoformat() }}" />
<meta property="og:type:article:tag" content="{{ article.tags }}" />
{% endblock %}

{% block content %}
  <h2>{{ article.title }}</h2>
  <p>By: {{ article.author.username }} on {{ article.created_at.strftime('%Y-%m-%d') }}</p>
  <p>{{ article.content }}</p>

  <form action="{{ url_for('like_article', article_id=article.id) }}" method="POST">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <button type="submit" name="submit" class="btn btn-create-article">Like ({{ article.likes }})</button>
  </form>

  {% if current_user.is_authenticated and current_user.is_admin %}
    <form action="{{ url_for('edit_article', id=article.id) }}" method="POST">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" id="title" name="title" value="{{ article.title|safe }}" />
      <input type="hidden" id="content" name="content" value="{{ article.content|safe }}" />
      <input type="hidden" id="tags" name="tags" value="{{ article.tags|safe }}" />
      <button type="submit" name="submit" class="btn btn-create-article">Edit</button>
    </form>
    <form action="{{ url_for('delete_article', article_id=article.id) }}" method="POST">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button type="submit" name="submit" class="btn btn-create-article" onclick="return confirm('Are you sure you want to delete this article?')">Delete</button>
    </form>
  {% endif %}
{% endblock %}